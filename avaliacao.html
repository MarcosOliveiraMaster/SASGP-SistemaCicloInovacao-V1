<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Avalia√ß√£o - SASGP</title>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
    <script src="banco.js" defer></script>
    <script src="script.js" defer></script>
    <script src="utilitarios.js" defer></script>
    <script src="script-extra.js" defer></script>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="style-extra.css">
</head>
<body>
    <div class="container">
        <div class="avaliacao-container">
            <!-- Banner Superior -->
            <div class="avaliacao-header">
                <div>
                    <h1>Avalia√ß√µes da Solu√ß√£o</h1>
                    <p id="nomeSolucaoAvaliacao" class="subtitle">Carregando...</p>
                </div>
                <button class="btn btn-voltar" onclick="window.location.href='index.html'">
                    ‚Üê Voltar
                </button>
            </div>

            <!-- Informa√ß√µes da Solu√ß√£o -->
            <div class="avaliacao-info-grid">
                <div class="info-card">
                    <h3>Status Atual</h3>
                    <div class="status-indicator">
                        <div class="status-dot" id="statusDot"></div>
                        <span class="status-text" id="statusText">Carregando...</span>
                    </div>
                </div>
                <div class="info-card">
                    <h3>Score da Solu√ß√£o</h3>
                    <p id="scoreSolucao">0%</p>
                </div>
                <div class="info-card">
                    <h3>Data de Cria√ß√£o</h3>
                    <p id="dataCriacaoSolucao">--/--/----</p>
                </div>
            </div>

            <!-- Seletor de Status -->
            <div class="status-selector">
                <label>Alterar Status:</label>
                <select id="selectStatus" class="filter-select">
                    <option value="em-analise">Em An√°lise</option>
                    <option value="aprovada-aguardando">Aprovada - Aguardando</option>
                    <option value="aprovada-execucao">Aprovada - Em Execu√ß√£o</option>
                    <option value="arquivada">Arquivada</option>
                    <option value="reprovada">Reprovada</option>
                </select>
                <button class="btn btn-primary" id="btnAtualizarStatus">Atualizar Status</button>
            </div>

            <!-- Resumo de Avalia√ß√µes -->
            <div class="rating-summary">
                <h3>M√©dia de Avalia√ß√µes</h3>
                <div class="average-stars" id="averageStars">‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ</div>
                <div class="average-value" id="averageValue">0.0</div>
                <div class="average-count" id="averageCount">0 avalia√ß√µes</div>
            </div>

            <!-- Filtros -->
            <div class="filters-container">
                <select id="filterAutor" class="filter-select">
                    <option value="todos">Todos os Autores</option>
                    <option value="Simone">Simone</option>
                    <option value="Gabriel">Gabriel</option>
                    <option value="Diego">Diego</option>
                    <option value="Emily">Emily</option>
                </select>
                <select id="filterEstrelas" class="filter-select">
                    <option value="todos">Todas as Avalia√ß√µes</option>
                    <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5 estrelas)</option>
                    <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ (4 estrelas)</option>
                    <option value="3">‚≠ê‚≠ê‚≠ê‚òÜ‚òÜ (3 estrelas)</option>
                    <option value="2">‚≠ê‚≠ê‚òÜ‚òÜ‚òÜ (2 estrelas)</option>
                    <option value="1">‚≠ê‚òÜ‚òÜ‚òÜ‚òÜ (1 estrela)</option>
                </select>
                <button class="btn btn-secondary" id="btnFiltrar">Filtrar</button>
                <button class="btn btn-secondary" id="btnRecarregarAvaliacoes" title="Recarregar avalia√ß√µes">
                    üîÑ Atualizar
                </button>
                <button class="btn btn-primary" id="btnAdicionarAvaliacao">
                    + Adicionar Avalia√ß√£o
                </button>
            </div>

            <!-- Grid de Cards de Avalia√ß√£o -->
            <div class="avaliacoes-grid" id="avaliacoesGrid">
                <!-- Cards ser√£o carregados aqui -->
            </div>

            <!-- Mensagem quando n√£o houver avalia√ß√µes -->
            <div id="semAvaliacoes" class="sem-avaliacoes" style="display: none;">
                <div style="font-size: 3rem; margin-bottom: 20px;">üìù</div>
                <h3>Nenhuma avalia√ß√£o encontrada</h3>
                <p>Seja o primeiro a avaliar esta solu√ß√£o!</p>
            </div>
        </div>
    </div>

    <!-- Modal para Adicionar Avalia√ß√£o -->
    <div id="modalAvaliacao" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Nova Avalia√ß√£o</h3>
                <button class="close-modal" id="closeModalAvaliacao">√ó</button>
            </div>
            
            <div class="form-group">
                <label for="selectAvaliador" class="rating-label">Avaliador</label>
                <select id="selectAvaliador" class="filter-select">
                    <option value="Simone">Simone</option>
                    <option value="Gabriel">Gabriel</option>
                    <option value="Diego">Diego</option>
                    <option value="Emily">Emily</option>
                    <option value="Outro">Outro</option>
                </select>
            </div>

            <div class="form-group">
                <label class="rating-label">Avalia√ß√£o (1-5 estrelas)</label>
                <div class="estrelas-container">
                    <span class="estrela" data-value="1">‚òÜ</span>
                    <span class="estrela" data-value="2">‚òÜ</span>
                    <span class="estrela" data-value="3">‚òÜ</span>
                    <span class="estrela" data-value="4">‚òÜ</span>
                    <span class="estrela" data-value="5">‚òÜ</span>
                </div>
                <div class="rating-value">
                    Selecionado: <span id="ratingValue">0</span> estrelas
                </div>
            </div>

            <div class="form-group">
                <label for="comentarioAvaliacao" class="rating-label">Coment√°rio</label>
                <textarea 
                    id="comentarioAvaliacao" 
                    placeholder="Deixe seu coment√°rio sobre a solu√ß√£o..."
                    maxlength="500"
                    rows="4"></textarea>
                <div class="char-counter">
                    <span id="charCount">0</span>/500 caracteres
                </div>
            </div>

            <div class="modal-buttons">
                <button class="btn btn-cancel" id="cancelAvaliacao">Cancelar</button>
                <button class="btn btn-primary" id="salvarAvaliacao">Salvar Avalia√ß√£o</button>
            </div>
        </div>
    </div>

    <!-- Modal para Ver Detalhes da Avalia√ß√£o -->
    <div id="modalDetalhesAvaliacao" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Detalhes da Avalia√ß√£o</h3>
                <button class="close-modal" id="closeModalDetalhes">√ó</button>
            </div>
            
            <div class="detalhes-avaliacao">
                <div class="detalhes-item">
                    <label>Avaliador</label>
                    <p id="detalheAvaliador">-</p>
                </div>
                <div class="detalhes-item">
                    <label>Avalia√ß√£o</label>
                    <div class="estrelas-detalhes" id="detalheEstrelas">‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ</div>
                </div>
                <div class="detalhes-item">
                    <label>Data</label>
                    <p id="detalheData">-</p>
                </div>
                <div class="detalhes-item">
                    <label>Coment√°rio</label>
                    <p id="detalheComentario">-</p>
                </div>
            </div>

            <div class="modal-buttons">
                <button class="btn btn-primary" id="fecharDetalhes">Fechar</button>
                <button class="btn btn-secondary" id="excluirAvaliacao" style="background: #ff4444; color: white;">
                    Excluir Avalia√ß√£o
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Confirma√ß√£o de Exclus√£o -->
    <div id="modalConfirmacaoExclusao" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Confirmar Exclus√£o</h3>
                <button class="close-modal" id="closeModalConfirmacao">√ó</button>
            </div>
            
            <p class="confirmacao-texto">
                Tem certeza que deseja excluir esta avalia√ß√£o? Esta a√ß√£o n√£o pode ser desfeita.
            </p>

            <div class="modal-buttons">
                <button class="btn btn-cancel" id="cancelarExclusao">Cancelar</button>
                <button class="btn btn-primary" id="confirmarExclusao" style="background: #ff4444; color: white;">
                    Excluir Permanentemente
                </button>
            </div>
        </div>
    </div>
</body>
</html>